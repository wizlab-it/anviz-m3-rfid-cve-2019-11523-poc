# Anviz M3 RFID Access Control security issues

Security issues have been found in the Anviz M3 RFID Access Control device when working in standalone mode, that could lead to access control bypass and private informations leakage and alteration.



### Advisory information

TITLE: Anviz M3 RFID Access Control security issues

ADVISORY URL: https://github.com/wizzent/anviz-m3-rfid-poc

DATE PUBLISHED: 

AFFECTED VENDORS: Anviz

AFFECTED PRODUCT: M3 Outdoor RFID Access Control (https://www.anviz.com/product/69.html)

RELEASE MODE: 

CVE: CVE-2019-11523



## Product description

From the vendor website:

> M3 is a metal casing, IP65 water-proof design compact access control device, suitable for outdoor applications.It is compatible with ISO14443 contactless card standards, support 13.56MHZ mifare card and 125KHZ EM card. The touch backlit keypad, support TCP/IP and RS485 communication convenient for customers to use. The M3 both with built-in relay for direct lock and standard wiegand output, can be work as standalone access control and RFID reader all in one device.

The M3 devices stores internally informations about users' RFID badges and/or passcode, and grants access if a valid RFID badge is presented or valid passcode is entered.

The M3 device can be managed using the CrossChex software. M3 can be connected to the PC via USB or TCP/IP for remote control.



## Details of vulnerabilities

Security issues have been found when the M3 device is connected on a local TCP/IP network.

The communication protocol has no authentication or encryption. Opening a connection on the device allows to send any command and retrieve any information from the internal memory.

List of main actions:

- send the "open door" command
- retrieve list of users (includes RFID and passcode in plaintext)
- altering users in local memory (add, edit, delete)
- retrieve and/or alter access records

Same kind of actions can be executed locally and remotely, in the case the M3 device is exposed on internet via public IP Address.

A Python PoC script has been released.



## Disclosure timeline

- 03/10/2018 - Vulnerabilities found
- 10/10/2018 - Report to Sony - Report to Sony Bug bounty program
- ...
- 17/04/2019 - xen1thLabs requests a CVE from MITRE
- 23/04/2019 - Public disclosure



## Solution

Anviz said the bugs have been fixed in the M3pro device.



# Mitigation

A mitigation is to keep the M3 device disconnected from a TCP/IP network, loosing all the remote monitoring and management functionalities.



## Credits

WizLab.it



## REFERENCES

Product page
https://www.anviz.com/product/69.html

PoC
https://github.com/wizzent/anviz-m3-rfid-poc
