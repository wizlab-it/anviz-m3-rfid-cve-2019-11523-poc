# Anviz M3 RFID Access Control security issues

Security issues have been found in the Anviz M3 RFID Access Control device when working in standalone mode connected to a TCP/IP network, that could lead to access control bypass and private informations leakage and alteration.



### Advisory information

TITLE: Anviz M3 RFID Access Control security issues

ADVISORY URL: https://github.com/wizlab-it/anviz-m3-rfid-cve-2019-11523-poc/

DATE PUBLISHED: ????????????

AFFECTED VENDORS: Anviz

AFFECTED PRODUCT: M3 Outdoor RFID Access Control (https://www.anviz.com/product/69.html)

RELEASE MODE: ????????????

CVE: CVE-2019-11523



### Product description

From the vendor website:

> M3 is a metal casing, IP65 water-proof design compact access control device, suitable for outdoor applications.It is compatible with ISO14443 contactless card standards, support 13.56MHZ mifare card and 125KHZ EM card. The touch backlit keypad, support TCP/IP and RS485 communication convenient for customers to use. The M3 both with built-in relay for direct lock and standard wiegand output, can be work as standalone access control and RFID reader all in one device.

The M3 devices stores internally informations about users' RFID badges and/or passcode, and grants access if a valid RFID badge is presented or valid passcode is entered.

The M3 device can be managed using the CrossChex software. It can be connected to the PC via USB cable or Ethernet cable in a privare/public TCP/IP network for remote management and monitoring.



### Details of vulnerabilities

Security issues have been found when the M3 device is connected on a TCP/IP network.

The communication protocol has no authentication or encryption. Opening a connection on the device allows the attacker to send any command and retrieve/alter any information from/on the internal memory.

List of main actions:

- send the "open door" command
- retrieve list of users (includes RFID and passcode in plaintext)
- retrieve and alter users in local memory (show, add, edit, delete)
- retrieve and alter access records

Same kind of actions can be executed either from a local (private) and remote (public, internet) network.

Extra problems are brought by the CrossChex application used to manage the M3 device, since it has some misleading features that could make the users thinking to have secured the M3 device, whilst they are ineffective to protect it. More in details:

- the password that can be set at the login only restrict the access to the application on the current PC. Installing the same application on another PC, the M3 device can be accessed with no restrictions
- when connecting the M3 device to the CrossChex application, a "Comm PWD" parameter is available. Indeed this parameter is not used in the TCP/IP connection
- in the Device Parameters dialog window another "password" field is included but it has no effects

A Python PoC script has been released to describe the vulnerabilities that have been found. The script allows also to scan the local network looking for Anviz devices (MAC address matching).



### Disclosure timeline

- 2019/04/10 - Vulnerabilities found
- 2019/04/10 - Report to Anviz (e-mail sent to the support address)
- 2019/04/18 - No response from Anviz yet, sent another e-mail
- 2019/04/18 - Anviz acknowledge the reception of the report
- 2019/04/19 - Anviz required more info about the version of the M3 device in use and provided some possible workarounds to the problem
- 2019/04/19 - Report to Anviz saying the workarounds are ineffective
- 2019/04/23 - Anviz suggests to use the M3pro device instead of the M3
- 2019/04/25 - Received a CVE from Mitre (CVE-2019-11523). Asked to Anviz how they want to handle this case
- 2019/04/29 - Anviz confirmed they have fixed the bugs in M3pro devices
- 2019/04/29 - Asked informations about the M3pro device since on their website only the M3 device is listed
- ...
- ?????????? - Public disclosure



### Solution

Anviz said the bugs have been fixed in the M3pro device.



### Mitigation

A mitigation is to keep the M3 device disconnected from a TCP/IP network, losing all the remote monitoring and management functionalities over TCP/IP.



### Alternative protocols

M3 device also supports Wiegand Protocol and RS485: these have not been tested here.



### Credits

WizLab.it



### References

Product page
https://www.anviz.com/product/69.html

PoC
https://github.com/wizlab-it/anviz-m3-rfid-cve-2019-11523-poc/
